% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rocvb.R
\name{auc.ci.mar}
\alias{auc.ci.mar}
\title{Confidence Intervals for AUC Under MAR Verification}
\usage{
auc.ci.mar(
  T,
  D,
  A,
  alpha = 0.05,
  search_step = 0.01,
  tol = 1e-05,
  precision = 1e-04,
  n.boot = 1000,
  plot = TRUE
)
}
\arguments{
\item{T}{Test results; a positive numeric vector.}

\item{D}{Verified disease status; a logical vector with possible missing values.}

\item{A}{Covariate; a positive numeric vector. Only one covariate is allowed.}

\item{alpha}{Significance level for the confidence interval. Default is 0.05.}

\item{search_step}{Step size used in root searching. Default is 0.01.}

\item{tol}{Tolerance used in root searching. Default is 1e-5.}

\item{precision}{Precision parameter used in the regression model. Default is 1e-4.}

\item{n.boot}{Number of bootstrap replicates. Default is 1000.}

\item{plot}{Logical; if \code{TRUE} (default) a density plot is produced.}
}
\value{
A list with elements:
\describe{
\item{\code{n.total}}{Total number of subjects.}
\item{\code{n.case}}{Number of verified diseased subjects.}
\item{\code{n.control}}{Number of verified non-diseased subjects.}
\item{\code{p.missing}}{Proportion of missing verification.}
\item{\code{pt.est}}{Point estimates of AUC.}
\item{\code{BC.intervals}}{Bootstrap classic (BC) confidence intervals.}
\item{\code{BP.intervals}}{Bootstrap percentile (BP) confidence intervals.}
\item{\code{HEL1.intervals}}{Hybrid empirical likelihood confidence intervals, type I.}
\item{\code{HEL2.intervals}}{Hybrid empirical likelihood confidence intervals, type II.}
}
}
\description{
Computes point estimates and confidence intervals for the AUC of a continuous
test when disease verification is missing at random (MAR). The function returns
four sets of estimates, obtained using the bias-corrected estimators FI, MSI,
IPW, and SPE proposed by Alonzo and Pepe (2005).
}
\details{
Bootstrap and hybrid empirical likelihood confidence intervals for AUC under
verification bias are computed.

The disease model \eqn{\rho} is estimated using a probit regression model
linear in \eqn{T} and \eqn{A} based on verified subjects, given by

\deqn{
  \rho_i = P(D_i = 1 \mid T_i, A_i)
  = \Phi(\alpha + \beta T_i + \gamma A_i),
  \quad i = 1, \ldots, n.
}

where \eqn{\Phi} denotes the standard normal cumulative distribution function.

The verification model is estimated using a logit regression model
linear in \eqn{T} and \eqn{A} based on all subjects, given by

\deqn{
  \operatorname{logit}(\pi_i)
  = \log\!\left( \frac{\pi_i}{1 - \pi_i} \right)
  = \alpha + \beta T_i + \gamma A_i,
  \quad i = 1, \ldots, n,
}

where \eqn{\pi_i = P(V_i = 1 \mid T_i, A_i)}.

The function may also produce a density plot of the test measurements when \code{plot = TRUE}.
}
\examples{
set.seed(123)
T <- abs(rnorm(100))
A <- abs(rnorm(100))
D <- as.logical(T + A > stats::quantile(T + A, 0.8))
D[sample(100, 30)] <- NA
auc.ci.mar(T, D, A, n.boot = 20, plot = FALSE)
}
\references{
Alonzo, T. A. and Pepe, M. S. (2005). Assessing accuracy of a continuous
screening test in the presence of verification bias. \emph{Journal of the Royal
Statistical Society: Series C (Applied Statistics)}.

Wang, S., Shi, S., and Qin, G. (2025). Empirical likelihood inference for the area
under the ROC curve with verification-biased data. Manuscript under peer review.
}
